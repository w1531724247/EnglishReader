<head></head>
<body><a name="//apple_ref/doc/uid/TP40000983-CH206" title="About Handlers"></a>
    <div id="_omniture_top">
        <!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
        <script type="text/javascript">
            /* RSID: */
            var s_account="appleglobal,appleusdeveloper,dappdeveloperlib"
            </script>
        
        <script type="text/javascript" src="https://www.apple.com/metrics/scripts/s_code_h.js"></script>
        <script type="text/javascript">
            s.pageName=AC.Tracking.pageName();
            s.channel="www.us.developer"
            
            /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
            var s_code=s.t();if(s_code)document.write(s_code)</script>
        <!-- End SiteCatalyst code version: H.8. -->
    </div>
    
    <div id="adcHeader" class="hideOnPrint hideInXcode">
        <div id="ssi_Header" class="hideInXcode unified">
            <a id="ssi_LibraryTitle" href="../../../../../navigation/" onclick="s_objectID=&quot;file:///var/mobile/navigation/_1&quot;;return this.s_oc?this.s_oc(e):true">Unified</a>
            <a id="ssi_AppleDeveloperConnection" href="https://developer.apple.com/" onclick="s_objectID=&quot;https://developer.apple.com/_1&quot;;return this.s_oc?this.s_oc(e):true">Developer</a>
            <div id="ssi_SearchButton" role="button" title="Search">Search</div>
        </div>
        <form id="ssi_SearchMenu" method="get" action="../../../../../search/" accept-charset="utf-8">
            <label for="adcsearch">Search Unified</label>
            
            
            
            <input type="search" id="ssi_SearchField" name="q" accesskey="s" results="5">
                </form>
    </div>
    
    <header id="header">
        <div id="title" role="banner">
            <h1>AppleScript Language Guide</h1>
            <span id="file_links">
                <a id="PDF_link" role="button" tabindex="4" rel="alternate" title="Download PDF"><span id="pdf_icon"></span>PDF</a>
                <a id="Companion_link" role="button" tabindex="3" title="Download Companion File"><span id="companion_icon"></span>Companion File</a>
            </span>
        </div>
        <ul id="headerButtons" class="hideOnPrint" role="toolbar">
            <li id="toc_button" style="display:none">
                <button tabindex="5" id="table_of_contents" class="open" role="checkbox" aria-label="Show Table of Contents"><span class="disclosure"></span>Table of Contents</button>
            </li>
            <li id="jumpto_button" style="display:none" role="navigation"><select tabindex="6" id="jumpTo"><option value="top">Jump To…</option></select></li>
            <li id="downloadSample_button" style="display:none">
                <a id="Sample_link"><button id="Sample_button">Download Sample Code</button></a>
            </li>
        </ul>
    </header>
    <nav id="tocContainer" tabindex="7">
        <ul id="toc" role="tree"></ul>
    </nav>
    
    <article id="contents" tabindex="0" role="main">
        <div id="pageNavigationLinks_top" class="pageNavigationLinks">
            <a class="nextLink" rel="next" href="../reference/ASLR_classes.html" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_1&quot;;return this.s_oc?this.s_oc(e):true">Next</a><a class="previousLink" rel="prev" href="ASLR_script_objects.html" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/ASL_1&quot;;return this.s_oc?this.s_oc(e):true">Previous</a>
        </div>
        <a id="top" name="top"></a>
        <a id="INDEX" href="../index.html" style="display:none;" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/index.html_1&quot;;return this.s_oc?this.s_oc(e):true"></a>
        
        <a name="//apple_ref/doc/uid/TP40000983-CH206-CJBIDBJH" title="About Handlers"></a><h1 id="pageTitle">About Handlers</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_229"></a>When script developers want to factor and re-use their code, they can turn to handlers. A handler is a collection of statements that can be invoked by name. Handlers are also known as functions, subroutines, or methods.</p><p>This chapter describes how to work with handlers, in the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW3" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_1&quot;;return this.s_oc?this.s_oc(e):true">Handler Basics</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW14" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_2&quot;;return this.s_oc?this.s_oc(e):true">Handlers in Script Applications</a></span></p></li></ul>
        <p>For detailed reference information, see <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163762" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_2&quot;;return this.s_oc?this.s_oc(e):true">Handler Reference</a></span>.</p>
        <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW3" title="Handler Basics"></a><h2 class="jump">Handler Basics</h2>
            <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_230"></a>A <em class="newTerm">handler</em> is a collection of statements that can be invoked by name. Handlers are useful in scripts that perform the same action in more than one place. You can package statements that perform a specific task as a handler, give it a descriptive name, and call it from anywhere in the script. This makes the script shorter and easier to maintain.</p><p>A script can contain one or more handlers. However, you can not nest a handler definition within another handler (although a script object defined in a handler can contain other handlers).</p><p>The definition for a handler specifies the parameters it uses, if any, and may specify a class or classes for the parameter and a default value.</p><p>When you call a handler, you must list its parameters according to how they are specified in its definition. Handlers may have labeled, positional, or interleaved parameters, described in subsequent sections. If a parameter has a specified class, AppleScript will coerce the actual value to that class as if using the <code>as</code> operator. If a parameter has a default value, that parameter may be omitted.</p><p>A handler definition can contain variable declarations and statements. It may use a <code>return</code> statement (described in detail in <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163937" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_3&quot;;return this.s_oc?this.s_oc(e):true">return</a></code>) to return a value and exit the handler<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_231"></a>.</p>
            <p>The sections that follow provide additional information on working with handlers:</p>
            <ul class="ul">
                <li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW23" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_3&quot;;return this.s_oc?this.s_oc(e):true">Defining a Simple Handler</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW22" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_4&quot;;return this.s_oc?this.s_oc(e):true">Handlers with Labeled Parameters</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW13" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_5&quot;;return this.s_oc?this.s_oc(e):true">Handlers with Positional Parameters</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW20" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_6&quot;;return this.s_oc?this.s_oc(e):true">Handlers with Patterned Positional Parameters</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW11" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_7&quot;;return this.s_oc?this.s_oc(e):true">Recursive Handlers</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW10" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_8&quot;;return this.s_oc?this.s_oc(e):true">Errors in Handlers</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW4" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_9&quot;;return this.s_oc?this.s_oc(e):true">Passing by Reference Versus Passing by Value</a></span></p></li><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW1" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_10&quot;;return this.s_oc?this.s_oc(e):true">Calling Handlers in a tell Statement</a></span></p></li></ul><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW23" title="Defining a Simple Handler"></a><h3 class="jump">Defining a Simple Handler</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_232"></a>The following is a definition for a simple handler that takes any parameter value that can be displayed as text (presumably one representing a date) and displays it in a dialog box. The handler name is <code>rock</code>; its parameter is <code>around the clock</code>, where <code>around</code> is a parameter label and <code>clock</code> is the parameter name (<code>the</code> is an AppleScript filler for readability):</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on rock around the clock<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog (clock as text)<span></span></pre></td></tr><tr><td scope="row"><pre>end rock<span></span></pre></td></tr></tbody></table></div><p>This handler allows an English-like calling statement:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>rock around the current date -- call handler to display current date<span></span></pre></td></tr></tbody></table></div><p>A handler can have no parameters. To indicate that a handler has no parameters, you include a pair of empty parentheses after the handler name in both the handler definition and the handler call. For example, the following <code>helloWorld</code> script has no parameters.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_233"></a></p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on helloWorld()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello World"<span></span></pre></td></tr><tr><td scope="row"><pre>end<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>helloWorld() -- Call the handler<span></span></pre></td></tr></tbody></table></div></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW22" title="Handlers with Labeled Parameters"></a><h3 class="jump">Handlers with Labeled Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_234"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_235"></a>To define a handler with labeled parameters, you list the labels to use when calling the handler and the statements to be executed when it is called. (The syntax is shown in <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW2" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_4&quot;;return this.s_oc?this.s_oc(e):true">Handler Syntax (Labeled Parameters)</a></span>.)</p><p>Handlers with labeled parameters can also have a direct parameter. With the exception of the direct parameter, which must directly follow the handler name, labeled parameters can appear in any order, with the labels from the handler definition identifying the parameter values. This includes parameters listed in <code>given</code>, <code>with</code>, and <code>without</code> clauses (of which there can be any number).</p><p>The <code>findNumbers</code> handler in the following example uses the special label <code>given</code> to define a parameter with the label <code>given rounding</code>.</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>to findNumbers of numberList above minLimit given rounding:roundBoolean<span></span></pre></td></tr><tr><td scope="row"><pre>        set resultList to {}<span></span></pre></td></tr><tr><td scope="row"><pre>        repeat with i from 1 to (count items of numberList)<span></span></pre></td></tr><tr><td scope="row"><pre>            set x to item i of numberList<span></span></pre></td></tr><tr><td scope="row"><pre>            if roundBoolean then -- round the number<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Use copy so original list isn’t modified.<span></span></pre></td></tr><tr><td scope="row"><pre>                copy (round x) to x<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if x &gt; minLimit then<span></span></pre></td></tr><tr><td scope="row"><pre>                set end of resultList to x<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>        return resultList<span></span></pre></td></tr><tr><td scope="row"><pre>end findNumbers<span></span></pre></td></tr></tbody></table></div><p>The next statements show how to call <code>findNumbers</code> by passing a predefined <code>list</code> variable:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>set myList to {2, 5, 19.75, 99, 1}<span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of myList above 19 given rounding:true<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {20, 99}<span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of myList above 19 given rounding:false<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {19.75, 99}<span></span></pre></td></tr></tbody></table></div><p>You can also specify the value of the <code>rounding</code> parameter by using a <code>with</code> or <code>without</code> clause to indicate <code>true</code> or <code>false</code>. (In fact, when you compile the previous examples, AppleScript automatically converts <code>given rounding:true</code> to <code>with rounding</code> and <code>given rounding:false</code> to <code>without rounding</code>.) These examples pass a <code>list</code> object directly, rather than using a <code>list</code> variable as in the previous case:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>findNumbers of {5.1, 20.1, 20.5, 33} above 20 with rounding<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {33}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of {5.1, 20.1, 20.5, 33.7} above 20 without rounding<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {20.1, 20.5, 33.7}<span></span></pre></td></tr></tbody></table></div><p>Here is another handler that uses parameter labels:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>to check for yourNumber from startRange thru endRange<span></span></pre></td></tr><tr><td scope="row"><pre>    if startRange ≤ yourNumber and yourNumber ≤ endRange then<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "Congratulations! Your number is included."<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end check<span></span></pre></td></tr></tbody></table></div><p>The following statement calls the handler, causing it to display the <code>"Congratulations!"</code> message</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>check for 8 from 7 thru 10 -- call the handler<span></span></pre></td></tr></tbody></table></div></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW13" title="Handlers with Positional Parameters"></a><h3 class="jump">Handlers with Positional Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_236"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_237"></a>The definition for a handler with positional parameters shows the order in which to list parameters when calling the handler and the statements to be executed when the handler is called. The definition must include parentheses, even if it doesn’t include any parameters. The syntax is shown in <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-166812" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_5&quot;;return this.s_oc?this.s_oc(e):true">Handler Syntax (Positional Parameters)</a></span>.</p><p>In the following example, the <code>minimumValue</code> routine returns the smaller of two values:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on minimumValue(x, y)<span></span></pre></td></tr><tr><td scope="row"><pre>    if x &lt; y then<span></span></pre></td></tr><tr><td scope="row"><pre>        return x<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        return y<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end minimumValue<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- To call minimumValue:<span></span></pre></td></tr><tr><td scope="row"><pre>minimumValue(5, 105) --result: 5<span></span></pre></td></tr></tbody></table></div><p>The first line of the <code>minimumValue</code> handler specifies the parameters of the handler. To call a handler with positional parameters you list the parameters in the same order as they are specified in the handler definition.</p><p>If a handler call is part of an expression, AppleScript uses the value returned by the handler to evaluate the expression. For example, to evaluate the following expression, AppleScript first calls <code>minimumValue</code>, then evaluates the rest of the expression.</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>minimumValue(5, 105) + 50 --result: 55<span></span></pre></td></tr></tbody></table></div></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW20" title="Handlers with Patterned Positional Parameters"></a><h3 class="jump">Handlers with Patterned Positional Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_238"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_239"></a>You can create a handler whose positional parameters define a pattern to match when calling the handler. For example, the following handler takes a single parameter whose pattern consists of two items in a list:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on displayPoint({x, y})<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog ("x = " &amp; x &amp; ", y = " &amp; y)<span></span></pre></td></tr><tr><td scope="row"><pre>end displayPoint<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- Calling the handler:<span></span></pre></td></tr><tr><td scope="row"><pre>set testPoint to {3, 8}<span></span></pre></td></tr><tr><td scope="row"><pre>displayPoint(testPoint)<span></span></pre></td></tr></tbody></table></div><p>A parameter pattern can be much more complex than a single list. The handler in the next example takes two numbers and a record whose properties include a list of bounds. The handler displays a dialog box summarizing some of the passed information.</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on hello(a, b, {length:l, bounds:{x, y, w, h}, name:n})<span></span></pre></td></tr><tr><td scope="row"><pre>    set q to a + b<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set response to "Hello " &amp; n &amp; ", you  are " &amp; l &amp; ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        " inches tall and occupy position (" &amp; x &amp;  ", " &amp; y &amp; ")."<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog response<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>end hello<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>set thing to {bounds:{1, 2, 4, 5}, name:"George", length:72}<span></span></pre></td></tr><tr><td scope="row"><pre>hello (2, 3, thing)<span></span></pre></td></tr><tr><td scope="row"><pre>--result: A dialog displaying “Hello George, you are 72 inches  tall<span></span></pre></td></tr><tr><td scope="row"><pre>--          and occupy position (1,2).”<span></span></pre></td></tr></tbody></table></div><p>The properties of a record passed to a handler with patterned parameters don’t have to be given in the same order in which they are given in the handler’s definition, as long as all the properties required to fit the pattern are present.</p><p>The following call to <code>minimumValue</code> uses the value from a handler call to <code>maximumValue</code> as its second parameter. The <code>maximumValue</code> handler (not shown) returns the larger of two passed numeric values.</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>minimumValue(20, maximumValue(1, 313)) --result: 20<span></span></pre></td></tr></tbody></table></div></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW2" title="Handlers with Interleaved Parameters"></a><h3 class="jump">Handlers with Interleaved Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_240"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_241"></a>A handler with interleaved parameters is a special case of one with positional parameters. The definition shows the order in which to list parameters when calling the handler and the statements to be executed when the handler is called, but the name of the handler is broken into pieces and interleaved with the parameters, which can make it easier to read.  Handlers with interleaved parameters may be used in any script, but are especially useful with bridged Objective-C methods, since they naturally resemble Objective-C syntax. The syntax is shown in <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW4" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_6&quot;;return this.s_oc?this.s_oc(e):true">Handler Syntax (Interleaved Parameters)</a></span>.</p><p>A handler with interleaved parameters may have only one parameter, as in this example:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on areaOfCircleWithRadius:radius<span></span></pre></td></tr><tr><td scope="row"><pre>    return radius ^ 2 * pi<span></span></pre></td></tr><tr><td scope="row"><pre>end areaOfCircleWithRadius:<span></span></pre></td></tr></tbody></table></div><p>Or more than one, as in this example:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on areaOfRectangleWithWidth:w height:h<span></span></pre></td></tr><tr><td scope="row"><pre>    return w * h<span></span></pre></td></tr><tr><td scope="row"><pre>end areaOfRectangleWithWidth:height:<span></span></pre></td></tr></tbody></table></div><p>To call a handler with interleaved parameters, list the parameters in the same order as they are specified in the handler definition. Despite the resemblance to labeled parameters, the parameters may not be reordered. Also, the call must be explicitly sent to an object, even if the target object is the default, <code>it</code>. For example:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>its foo:5 bar:105 --this works<span></span></pre></td></tr><tr><td scope="row"><pre>tell it to foo:5 bar:105 --as does this<span></span></pre></td></tr><tr><td scope="row"><pre>foo:5 bar:105 --syntax error.<span></span></pre></td></tr></tbody></table></div><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40000983-CH206-SW5" title="Note"></a><p><strong>Note:</strong>&nbsp;The actual name of an interleaved-parameter handler is all the name parts strung together with underscores, and is equivalent to a handler defined using that name with positional parameters. For example, these two handler declarations are equivalent:</p><p></p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on tableView:t objectValueForTableColumn:c row:r<span></span></pre></td></tr><tr><td scope="row"><pre>on tableView_objectValueForTableColumn_row_(t, c, r)<span></span></pre></td></tr></tbody></table></div>Given a compiled script, AppleScript will automatically translate between the two forms depending on whether or not the current system version supports interleaved parameters.<p></p><p></p></aside></div></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW12" title="Parameter Specifications"></a><h3 class="jump">Parameter Specifications</h3><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40000983-CH206-SW18" title="Note"></a><p><strong>Note:</strong>&nbsp;Parameter specifications are supported in OS X Yosemite v10.10 and later.</p><p></p></aside></div><p>The parameter “name” in a handler definition may be a simple name, as shown above, or it may additionally specify a required class and, for labeled parameters, a default value. To specify a required class, follow the name with <code>as</code> <em>class</em> or <code>as {</code><em>class</em><code>,</code>…<code>}</code>. For example, you could declare a parameter to be specifically an integer like this:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on factorial(x as integer)<span></span></pre></td></tr></tbody></table></div><p>The effect is as if the handler began with <code>set x to x as integer</code>; if coercing the actual value to an integer fails, AppleScript throws an appropriate error, which may be caught with a <code>try</code> block. The class may be a list of classes, as described in <span class="content_text"><a href="../reference/ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-124070" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_7&quot;;return this.s_oc?this.s_oc(e):true">Operators Reference</a></span>.</p><p>Labeled parameters may be declared with a default value by following the formal parameter name with <code>:</code><em>literal</em>. Doing so makes the parameter optional when called. For example, this declares a <code>make</code> handler with a default value for the <code>with data</code> parameter:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on make new theClass with data theData : missing value<span></span></pre></td></tr></tbody></table></div><p>This handler can now be called without supplying a <code>with data</code> parameter; the handler would see <code>theData</code> set to the specified default <code>missing value</code>, which it could then test for and handle appropriately.</p><p>A parameter may use both a type specification and a default value. For example, this declares a <code>make</code> handler with a <code>with properties</code> parameter that must be a record and has a default value of an empty record:</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on make new theClass with properties theProperties as record : {}<span></span></pre></td></tr></tbody></table></div></section>
            <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW11" title="Recursive Handlers"></a><h3 class="jump">Recursive Handlers</h3>
                <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_242"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_243"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_244"></a>A <em class="newTerm">recursive handler</em> is a handler that calls itself. For example, this recursive handler generates a factorial. (The factorial of a number is the product of all the positive integers from 1 to that number. For example, 4 factorial is equal to 1 * 2 * 3 * 4, or 24. The factorial of 0 is 1.)</p>
                <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on factorial(x)<span></span></pre></td></tr><tr><td scope="row"><pre>    if x &gt; 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>        return x * factorial(x - 1)<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        return 1<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end factorial<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- To call factorial:<span></span></pre></td></tr><tr><td scope="row"><pre>factorial(10)   --result: 3628800<span></span></pre></td></tr></tbody></table></div>
                <p>In the example above, the handler <code>factorial</code> is called once, passing the value <code>10</code>. The handler then calls itself recursively with a value of <code>x - 1</code>, or <code>9</code>. Each time the handler calls itself, it makes another recursive call, until the value of <code>x</code> is <code>0</code>. When <code>x</code> is equal to <code>0</code>, AppleScript skips to the <code>else</code> clause and finishes executing all the partially executed handlers, including the original <code>factorial</code> call.</p>
                <p>When you call a recursive handler, AppleScript keeps track of the variables and pending statements in the original (partially executed) handler until the recursive handler has completed. Because each call uses some memory, the maximum number of pending handlers is limited by the available memory. As a result, a recursive handler may generate an error before the recursive calls complete.</p>
                <p>In addition, a recursive handler may not be the most efficient solution to a problem. For example, the factorial handler shown above can be rewritten to use a <code>repeat</code> statement instead of a recursive call, as shown in the example in <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128207" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_8&quot;;return this.s_oc?this.s_oc(e):true">repeat with loopVariable (from startValue to stopValue)</a></code>.</p></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW10" title="Errors in Handlers"></a><h3 class="jump">Errors in Handlers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_245"></a>As with any AppleScript statements that may encounter an error, you can use a <code>try</code> statement to deal with possible errors in a handler. A <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_9&quot;;return this.s_oc?this.s_oc(e):true">try</a></code> statement includes two collections of statements: one to be executed in the general case, and a second to be executed only if an error occurs.</p><p>By using one or more <code>try</code> statements with a handler, you can combine the advantages of reuse and error handling in one package. For a detailed example that demonstrates this approach, see <span class="content_text"><a href="../reference/ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_10&quot;;return this.s_oc?this.s_oc(e):true">Working with Errors</a></span>.</p></section><section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW4" title="Passing by Reference Versus Passing by Value"></a><h3 class="jump">Passing by Reference Versus Passing by Value</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_246"></a>Within a handler, each parameter is like a variable, providing access to passed information. AppleScript passes all parameters by reference, which means that a passed variable is shared between the handler and the caller, as if the handler had created a variable using the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_11&quot;;return this.s_oc?this.s_oc(e):true">set</a></code> command. However, it is important to remember a point raised in <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW7" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/ASL_2&quot;;return this.s_oc?this.s_oc(e):true">Using the copy and set Commands</a></span>: only mutable objects can actually be changed.</p><p>As a result, a parameter’s class type determines whether information is effectively passed by value or by reference:</p><ul class="ul"><li class="li"><p>For mutable objects (those whose class is <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCGECID" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_12&quot;;return this.s_oc?this.s_oc(e):true">date</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_13&quot;;return this.s_oc?this.s_oc(e):true">list</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDGEAH" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_14&quot;;return this.s_oc?this.s_oc(e):true">record</a></code>, or <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_15&quot;;return this.s_oc?this.s_oc(e):true">script</a></code>), information is passed <em>by reference</em>:</p><p>If a handler changes the value of a parameter of this type, the original object is changed.</p></li><li class="li"><p>For all other class types, information is effectively passed <em>by value</em>:</p><p>Although AppleScript passes a reference to the original object, that object cannot be changed. If the handler assigns a new value to a parameter of this type, the original object is unchanged.</p></li></ul><p>If you <em>want</em> to pass by reference with a class type other than <code>date</code>, <code>list</code>, <code>record</code>, or <code>script</code>, you can pass a <code>reference</code> object that refers to the object in question. Although the handler will have access only to a copy of the <code>reference</code> object, the specified object will be the same. Changes to the specified object in the handler will change the original object, although changes to the <code>reference</code> object itself will not.</p></section>
            <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW1" title="Calling Handlers in a tell Statement"></a><h3 class="jump">Calling Handlers in a tell Statement</h3>
                <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_247"></a>To call a handler from within a <code>tell</code> statement, you must use the reserved words <code>of me</code> or <code>my</code> to indicate that the handler is part of the script and not a command that should be sent to the target of the <code>tell</code> statement.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_248"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_249"></a></p>
                <p>For example, the following script calls the <code>minimumValue</code> handler defined in <span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW13" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_11&quot;;return this.s_oc?this.s_oc(e):true">Handlers with Positional Parameters</a></span> from within a <code>tell</code> statement. If this call did not include the words <code>of me</code>, it would cause an error, because AppleScript would send the <code>minimumValue</code> command to TextEdit, which does not understand that message.</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>tell front document of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    minimumValue(12, 400) of me<span></span></pre></td></tr><tr><td scope="row"><pre>    set paragraph 1 to result as text<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr><tr><td scope="row"><pre>--result: The handler call is successful.<span></span></pre></td></tr></tbody></table></div>
                <p>Instead of using the words <code>of me</code>, you could insert the word <code>my</code> before the handler call:</p>
                <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>my minimumValue(12, 400)<span></span></pre></td></tr></tbody></table></div></section></section>
        <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW14" title="Handlers in Script Applications"></a><h2 class="jump">Handlers in Script Applications</h2>
            <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_250"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_251"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_252"></a>A <em class="newTerm">script application</em> is an application whose only function is to run the script associated with it. Script applications contain handlers that allow them to respond to commands. For example, many script applications can respond to the <code>run</code> command and the <code>open</code> command. A script application receives a <code>run</code> command whenever it is launched and an <code>open</code> command whenever another icon is dropped on its icon in the Finder. It can also contain other handlers to respond to commands such as <code>quit</code> or <code>print</code>.</p><p>When saving a script in Script Editor, you can create a script application by choosing either Application or Application Bundle from the File Format options. Saving as Application results in a simple format that is compatible with Mac OS 9.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_253"></a> Saving as Application Bundle results in an application that uses the modern bundle format, with its specified directory structure, which is supported back to OS X v10.3.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_254"></a></p><p>When creating a script application, you can also specify whether a <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_255"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_256"></a>startup screen should appear before the application runs its script. Whatever you write in the Description pane of the script window in Script Editor is displayed in the startup screen. <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_257"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_258"></a>You can also specify in Script Editor whether a script application should stay open after running. The default is for the script to quit immediately after it is run.</p><p>You can run a script application from the Finder much like any other application. If it has a startup screen, the user must click the Run button or press the Return key before the script actually runs.</p><p>Consider the following simple script</p><div class="codesample clear"><table><tbody><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    close front window<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></tbody></table></div><p>What this script does as a script application depends on what you specify when you save it. If you don’t specify a startup screen or tell it to stay open, it will automatically execute once, closing the front Finder window, and then quit.</p><p>If a script application modifies the value of a property, the changed value persists across launches of the application. For related information, see <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW1" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/ASL_3&quot;;return this.s_oc?this.s_oc(e):true">Scope of Variables and Properties</a></span>.</p>
            <p>For information about some common script application handlers, see the following sections:</p>
            <ul class="ul"><li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW15" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_12&quot;;return this.s_oc?this.s_oc(e):true">run Handlers</a></span></p></li>
                <li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW16" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_13&quot;;return this.s_oc?this.s_oc(e):true">open Handlers</a></span></p></li>
                <li class="li"><p><span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW7" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_14&quot;;return this.s_oc?this.s_oc(e):true">idle and quit Handlers for Stay-Open Applications</a></span></p></li></ul><p>See <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163762" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_16&quot;;return this.s_oc?this.s_oc(e):true">Handler Reference</a></span> for syntax information.</p>
            <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW15" title="run Handlers"></a><h3 class="jump">run Handlers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_259"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_260"></a>When you run a script or launch a script application, its <code>run</code> handler is invoked. A script’s <code>run</code> handler is defined in one of two ways:</p><ul class="ul"><li class="li"><p>As an implicit <code>run</code> handler, which consists of all statements declared outside any handler or nested <code>script</code> object in a script.</p><p>Declarations for properties and <code>global</code> variables are not considered statements in this context—that is, they are not considered to be part of an implicit <code>run</code> handler.</p></li><li class="li"><p>As an explicit <code>run</code> handler, which is enclosed within <code>on run</code> and <code>end</code> statements, similar to other handlers.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_261"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_262"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_263"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_264"></a></p></li></ul><p>Having both an implicit and an explicit <code>run</code> handler is not allowed, and causes a syntax error during compilation. If a script has no run handler (for example, a script that serves as a library of handlers, as described in <span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW12" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_15&quot;;return this.s_oc?this.s_oc(e):true">Parameter Specifications</a></span>), executing the script does nothing. However, sending it an explicit <code>run</code> command causes an error.</p>
                <p>The following script demonstrates an implicit <code>run</code> handler. The script consists of a statement that invokes the <code>sayHello</code> handler, and the definition for the handler itself:</p>
                <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello"<span></span></pre></td></tr><tr><td scope="row"><pre>end sayHello<span></span></pre></td></tr></tbody></table></div>
                <p>The implicit <code>run</code> handler for this script consists of the statement <code>sayHello()</code>, which is the only statement outside the handler. If you save this script as a script application and then run the application, the script receives a <code>run</code> command, which causes it to execute the one statement in the implicit <code>run</code> handler.</p>
                <p>You can rewrite the previous script to provide the exact same behavior with an explicit <code>run</code> handler:</p>
                <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on run<span></span></pre></td></tr><tr><td scope="row"><pre>    sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello"<span></span></pre></td></tr><tr><td scope="row"><pre>end sayHello<span></span></pre></td></tr></tbody></table></div>
                <p>Whether a script is saved as a script application or as a compiled script, its <code>run</code> handler is invoked when the script is run. You can also invoke a <code>run</code> handler in a script application from another script. For information about how to do this, see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW17" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_16&quot;;return this.s_oc?this.s_oc(e):true">Calling a Script Application From a Script</a></span>.</p></section>
            <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW16" title="open Handlers"></a><h3 class="jump">open Handlers</h3>
                <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_265"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_266"></a>Mac apps, including script applications, receive an <code>open</code> command whenever the user drops file, folder, or disk icons on the application’s Finder icon, even if the application is already running.</p>
                <p>If the script in a script application includes an <code>open</code> handler, the handler is executed when the application receives the <code>open</code> command. The <code>open</code> handler takes a single parameter which provides a list of all the items to be opened. Each item in the list is an<code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW3" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_17&quot;;return this.s_oc?this.s_oc(e):true">alias</a></code> object.</p>
                <p>For example, the following <code>open</code> handler makes a list of the pathnames of all items dropped on the script application’s icon and saves them in the frontmost TextEdit document:</p>
                <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on open names<span></span></pre></td></tr><tr><td scope="row"><pre>    set pathNamesString to "" -- Start with empty text string.<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with i in names<span></span></pre></td></tr><tr><td scope="row"><pre>        -- In this loop, you can perform operations on each dropped item.<span></span></pre></td></tr><tr><td scope="row"><pre>        -- For now, just get the name and append a return character.<span></span></pre></td></tr><tr><td scope="row"><pre>        set iPath to (i as text)<span></span></pre></td></tr><tr><td scope="row"><pre>        set pathNamesString to pathNamesString &amp; iPath &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Store list in open document, to verify what was dropped.<span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>        set paragraph 1 of front document to pathNamesString<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    return<span></span></pre></td></tr><tr><td scope="row"><pre>end open<span></span></pre></td></tr></tbody></table></div>
                <p>Files, folders, or disks are not moved, copied, or affected in any way by merely dropping them on a script application. However, the script application’s handler can tell Finder to move, copy, or otherwise manipulate the items. For examples that work with Finder items, see <span class="content_text"><a href="../reference/ASLR_folder_actions.html#//apple_ref/doc/uid/TP40000983-CH219-SW2" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_18&quot;;return this.s_oc?this.s_oc(e):true">Folder Actions Reference</a></span>.</p>
                <p>You can also run an <code>open</code> handler by sending a script application the <code>open</code> command. For details, see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW17" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_17&quot;;return this.s_oc?this.s_oc(e):true">Calling a Script Application From a Script</a></span>.</p></section>
            <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW7" title="idle and quit Handlers for Stay-Open Applications"></a><h3 class="jump">idle and quit Handlers for Stay-Open Applications</h3>
                <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_267"></a>By default, a script application that receives a <code>run</code> or <code>open</code> command handles that single command and then quits. In contrast, a stay-open script application (one saved as Stay Open in Script Editor) stays open after it is launched.</p>
                <p>A stay-open script application can be useful for several reasons:</p>
                <ul class="ul">
                    <li class="li"><p>Stay-open script applications can receive and handle other commands in addition to <code>run</code> and <code>open</code>. This allows you to use a script application as a script server that, when it is running, provides a collection of handlers that can be invoked by any other script.</p></li>
                    <li class="li"><p>Stay-open script applications can perform periodic actions, even in the background, as long as the script application is running.</p></li></ul><p>Two particular handlers that stay-open script applications often provide are an <code>idle</code> handler and a <code>quit</code> handler.</p>
                <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW8" title="idle Handlers"></a><h4 class="jump">idle Handlers</h4>
                    <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_268"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_269"></a>If a stay-open script application includes an <code>idle</code> handler, AppleScript sends the script application periodic <code>idle</code> commands—by default, every 30 seconds—allowing it to perform background tasks when it is not performing other actions.</p><p>If an <code>idle</code> handler returns a positive number, that number becomes the rate (in seconds) at which the handler is called. If the handler returns a non-numeric value, the rate is not changed. You can return 0 to maintain the default delay of 30 seconds.</p>
                    <p>For example, when saved as a stay-open application, the following script beeps every 5 seconds:</p>
                    <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on idle<span></span></pre></td></tr><tr><td scope="row"><pre>    beep<span></span></pre></td></tr><tr><td scope="row"><pre>    return 5<span></span></pre></td></tr><tr><td scope="row"><pre>end idle<span></span></pre></td></tr></tbody></table></div>
                    <p>The result returned from a handler is just the result of the last statement, even if it doesn’t include the word <code>return</code> explicitly. (See <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163937" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_19&quot;;return this.s_oc?this.s_oc(e):true">return</a></code> for more information.) For example, this handler gets called once a minute, because the value of the last statement is 60:</p>
                    <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on idle<span></span></pre></td></tr><tr><td scope="row"><pre>    set x to 10<span></span></pre></td></tr><tr><td scope="row"><pre>    beep<span></span></pre></td></tr><tr><td scope="row"><pre>    set x to x * 6  -- The handler returns the result (60).<span></span></pre></td></tr><tr><td scope="row"><pre>end idle<span></span></pre></td></tr></tbody></table></div></section>
                <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW9" title="quit Handlers"></a><h4 class="jump">quit Handlers</h4>
                    <p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_270"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_271"></a>AppleScript sends a stay-open script application a <code>quit</code> command whenever the user chooses the Quit menu command or presses Command-Q while the application is active. If the script includes a <code>quit</code> handler, the statements in the handler are run before the application quits.</p>
                    <p>A <code>quit</code> handler can be used to set script properties, tell another application to do something, display a dialog box, or perform almost any other task. If the handler includes a <code>continue quit</code> statement, the script application’s default quit behavior is invoked and it quits. If the <code>quit</code> handler returns before it encounters a <code>continue quit</code> statement, the application doesn’t quit.</p><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40000983-CH206-SW6" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>continue</code> statement passes control back to the application’s default <code>quit</code> handler. For more information, see <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW1" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_20&quot;;return this.s_oc?this.s_oc(e):true">continue</a></code>.</p><p></p></aside></div>
                    <p>For example, this handler checks with the user before allowing the application to quit:</p>
                    <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>on quit<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Really quit?" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        buttons {"No", "Quit"} default button  "Quit"<span></span></pre></td></tr><tr><td scope="row"><pre>    if the button returned of the result is "Quit" then<span></span></pre></td></tr><tr><td scope="row"><pre>        continue quit<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Without the continue statement, the application doesn't quit.<span></span></pre></td></tr><tr><td scope="row"><pre>end quit<span></span></pre></td></tr></tbody></table></div>
                    <div class="warningbox clear"><aside><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_8" title="Warning"></a><p><strong>Warning:</strong>&nbsp;
                        
                        If AppleScript doesn’t encounter a <code>continue quit</code> statement while executing an <code>on quit</code> handler, it may seem to be impossible to quit the application. For example, if the handler shown above gets an error before the <code>continue quit</code> statement, the application won’t quit. If necessary, you can use Force Quit (Command-Option-Esc) to halt the application. <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_272"></a></p><p></p><div class="clear"></div></aside></div></section></section></section>
        <section><a name="//apple_ref/doc/uid/TP40000983-CH206-SW17" title="Calling a Script Application From a Script"></a><h2 class="jump">Calling a Script Application From a Script</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_273"></a>A script can send commands to a script application just as it can to other applications. To launch a non-stay-open application and run its script, use a <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW51" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_21&quot;;return this.s_oc?this.s_oc(e):true">launch</a></code> command followed by a <code>run</code> command, like this:</p>
            <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>launch application "NonStayOpen"<span></span></pre></td></tr><tr><td scope="row"><pre>run application "NonStayOpen"<span></span></pre></td></tr></tbody></table></div>
            <p>The <code>launch</code> command launches the script application without sending it an implicit <code>run</code> command. When the <code>run</code> command is sent to the script application, it processes the command, sends back a reply if necessary, and quits.</p>
            <p>Similarly, to launch a non-stay-open application and run its <code>stringTest</code> handler (which takes a <code>text</code> object as a parameter), use a <code>launch</code> command followed by a <code>stringTest</code> command, like this:</p>
            <div class="codesample clear"><table><tbody><tr><td scope="row"><pre>tell application "NonStayOpen"<span></span></pre></td></tr><tr><td scope="row"><pre>    launch<span></span></pre></td></tr><tr><td scope="row"><pre>    stringTest("Some example text.")<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></tbody></table></div>
            <p>For information on how to create script applications, see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40000983-CH206-SW14" data-renderer-version="1" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/doc_18&quot;;return this.s_oc?this.s_oc(e):true">Handlers in Script Applications</a></span>.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_274"></a></p></section>
        <div id="pageNavigationLinks_bottom" class="pageNavigationLinks">
            <a class="nextLink" rel="next" href="../reference/ASLR_classes.html" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/reference/ASL_22&quot;;return this.s_oc?this.s_oc(e):true">Next</a><a class="previousLink" rel="prev" href="ASLR_script_objects.html" onclick="s_objectID=&quot;file:///var/mobile/Containers/Data/Application/341B9D8D-403F-4FB0-A940-F09CF6A66269/Documents/ASL_4&quot;;return this.s_oc?this.s_oc(e):true">Previous</a>
        </div><br>
        <div class="copyright"><br><hr><div align="center"><p class="content_text" lang="en" dir="ltr"> Copyright © 2016 Apple Inc. All Rights Reserved. <a href="http://www.apple.com/legal/internet-services/terms/site.html" target="_blank" onclick="s_objectID=&quot;http://www.apple.com/legal/internet-services/terms/site.html_1&quot;;return this.s_oc?this.s_oc(e):true">Terms of Use</a>   |  <a href="http://www.apple.com/privacy/" target="_blank" onclick="s_objectID=&quot;http://www.apple.com/privacy/_1&quot;;return this.s_oc?this.s_oc(e):true">Privacy Policy</a>  |  Updated: 2016-01-25</p></div></div>
        
        <div id="pediaWindow">
            <div id="pediaHeader"></div>
            <div id="pediaBody"></div>
        </div>
    </article>
    
    <div id="xcode_leave_feedback" class="button" role="button" tabindex="0">
        <a href="https://developer.apple.com/feedback/?v=4&amp;url=documentation%2FAppleScript%2FConceptual%2FAppleScriptLangGuide%2Fconceptual%2FASLR_about_handlers.html%3Fdocset%3Dcom.apple.adc.documentation-3.6%26id%3DTP40000983-5.2.0&amp;media=xcode" target="_blank" onclick="s_objectID=&quot;https://developer.apple.com/feedback/?v=4&amp;url=documentation%2FAppleScript%2FConceptual%2FAppleScr_1&quot;;return this.s_oc?this.s_oc(e):true">Feedback</a>
    </div>
    
    <script charset="utf-8" src="../../../../../Resources/1255/JavaScript/lib/prototype.js"></script>
    <script src="../../../../../Resources/1255/JavaScript/library.js"></script>
    <script src="../../../../../Resources/1255/JavaScript/feedback.js"></script>
    
    
    
    
</body>
